#!/bin/sh

# Check event synchronization in raw run data

runs=(20211110_1955 20211110_2123 20211111_0955 20211111_1056 20211111_1220 20211111_1330 20211111_1518 20211111_1610 20211111_1954 20211112_0840 20211112_1038 20211112_1305 20211112_1400 20211112_1445 20211112_1653 20211112_1933 20211113_0909 20211113_1005 20211113_1023 20211113_1043 20211113_1101 20211113_1118 20211113_1136 20211113_1159 20211113_1218 20211113_1235 20211113_1252 20211113_1312 20211113_1824 20211114_0933 20211114_0938 20211114_1122 20211114_1239 20211114_1506 20211114_1549 20211114_1752 20211114_2027)
geometry=nov2021
events=10

echo "Starting run checking..."
for run in ${runs[@]}; do
    ./RawToDigi $EOS_TESTBEAM/raw/run_$run*.raw /tmp/dump.root --geometry $geometry --events $events --check-sync --verbose >> /tmp/unpacker.out
    # print run conditions:
    if [ $? -eq 0 ]; then
        echo $run "good";
    else
        echo $run "bad";
    fi
done